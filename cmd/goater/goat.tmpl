{{define "goat-file"}}
    package {{.Package}}

    import (
    "github.com/tmr232/goat"
    "github.com/tmr232/goat/flags"
    cli "github.com/urfave/cli/v2"
    )

    {{- template "register-apps" .}}
{{end}}

{{define "register-apps"}}
    func init() {
    {{- range .Actions}}
        {{- template "register-function" . -}}
    {{- end -}}
    }
{{end}}


{{define "register-function"}}
    goat.Register({{.Function}}, goat.RunConfig{
    Flags: []cli.Flag{
    {{- range .Flags}}
        flags.MakeFlag[{{.Type}}]({{.Name}}, {{.Usage}}, {{.Default}}).AsCliFlag(),
    {{- end}}
    },
    Name: {{.Name}},
    Usage: {{.Usage}},
    Action: func(c *cli.Context) error {
    {{- if .NoError }}
        {{.Function}}(
        {{- range .Flags}}
            flags.GetFlag[{{.Type}}](c, {{.Name}}),
        {{- end}}
        )
        return nil
    {{- else}}
        return {{.Function}}(
        {{- range .Flags}}
            flags.GetFlag[{{.Type}}](c, {{.Name}}),
        {{- end}}
        )
    {{- end}}
    },
    })
{{end}}